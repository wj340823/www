<div  ng-controller="taskManageCtrl" style="height: calc(100% - 70px)">
    <div class="tab-task">
        <div class="tab-nav">
            <button class="tab-button" ui-sref="province.taskManage" ui-sref-active="active">
                任务管理
            </button>
            <button class="tab-button" ui-sref="province.record" ui-sref-active="active">
                排查记录
            </button>
            <button class="tab-button" ui-sref="province.majorDanger" ui-sref-active="active">
                重大隐患
            </button>
            <button class="tab-button" ui-sref="province.manageDanger" ui-sref-active="active">
                应急管理隐患
            </button>
        </div>
    </div>
    <div class="message" ng-show="msgState">
        <div class="selCity">
            <div class="item-title">选择市州</div>
            <div  class="sel">
                <input type="checkbox" ng-model="selAll"
                       ng-change="selectAll()">全选
            </div>
            <div ng-repeat="item in areas track by $index" class="sel">
                <input type="checkbox" ng-model="item[$index].sel"
                       ng-change="getOrgPeople(item.id,$index)">{{item.name}}
            </div>
        </div>
        <div style="float:left;width:800px;height:500px" >
            <div class="item-title">选择联系人
                <span style="color:#fff;float:right;margin-right:10px" ng-click="closeMsg()">
                    <i class="iconfont icon-guanbi"></i>
                </span>
            </div>
            <div style="color:#fc0">
                <div class="xm" >职位</div>
                <div class="xm" >姓名</div>
                <div class="tel" >手机号</div>
                <div class="xh" >操作</div>
                <div class="clearfix"></div>
            </div>
            <div cgs-slim options="{'size':'3px','height':'360px'}">
                <div ng-repeat="(key, value) in msgObj" >
                    <div ng-repeat="item in msgObj[key] track by $index">
                        <div class="xm">{{item.position}}</div>
                        <div class="xm">{{item.name}}</div>
                        <div class="tel">{{item.tel}}</div>
                        <div class="xh oper" ng-click="delMsg(key,$index)">删除</div>
                        <div class="clearfix"></div>
                    </div>
                </div>
                <div >
                    <button class="searchBtn" ng-click="openTest()" ng-show="msgObj.test.length==0">测试验证短信</button>
                </div>
            </div>
            <div class="operate">
                <button class="searchBtn " ng-click="msgSend()" style="float:right;margin-right:30px">确认</button>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="table-content">
        <div class="search-nav">
            <span>任务状态：</span>
            <input type="radio" ng-model="items.status" value="-1" class="regular-radio" id="radio1"/>
            <label for="radio1" class="hander"></label>
            <span style="margin-right: 10px">全部</span>
            <input type="radio" ng-model="items.status" value="2" class="regular-radio" id="radio4"/>
            <label for="radio4" class="hander"></label>
            <span style="margin-right: 10px">超时</span>
            <input type="radio" ng-model="items.status" value="1" class="regular-radio" id="radio3"/>
            <label for="radio3" class="hander"></label>
            <span style="margin-right: 10px">预警</span>
            <input type="radio" ng-model="items.status" value="0" class="regular-radio" id="radio2"/>
            <label for="radio2" class="hander"></label>
            <span style="margin-right: 10px">执行中</span>
            <input type="radio" ng-model="items.status" value="10" class="regular-radio" id="radio5"/>
            <label for="radio5" class="hander"></label>
            <span >已完成</span>
            <span style="margin-left: 20px">截止日期：</span><input cgs-date-picker  date-fmt="yyyy-MM-dd"
                        ng-model="items.strTime" /> ~
            <input cgs-date-picker date-fmt="yyyy-MM-dd"
                   ng-model="items.endTime"  style="margin-right: 20px"/>
        </div>

        <div class="search-nav">
            <span>任务名称：</span><input type="text" placeholder="任务名称" ng-model="items.keywords">
            <button class="searchBtn" style="margin-left: 20px" ng-click="searchMsg()">
                <i class="iconfont icon-sousuo"></i>搜索
            </button>
            <button style="margin-left: 20px" ui-sref="province.taskApply" class="searchBtn">任务派发</button>
            <button style="margin-left: 20px" class="searchBtn" ng-click="openMsg()">短信提醒</button>
        </div>
        <table style="margin-top: 16px;">
            <thead>
            <tr>
                <th>序号</th>
                <th>行政区划</th>
                <th>任务名称</th>
                <th>截止日期</th>
                <th>企业总数</th>
                <th>已完成企业</th>
                <th>任务状态</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="item in obj">
                <td>{{(items.pageNo-1)*items.pageSize+$index+1}}</td>
                <td>贵州省</td>
                <td>{{item.NAME}}</td>
                <td>{{item.DEADLINE | date:'yyyy-MM-dd'}}</td>
                <td>{{item.sum}}</td>
                <td>{{item.csum}}</td>
                <td ng-class="item.STATUS=='10'?'finishColor':item.STATUS=='1'?'warning':item.STATUS=='2'?'dangerColor':''"><!--状态位:0-进行中，1-预警，2-超时，10-已完成-->
                    {{item.STATUS=='0'?'执行中':item.STATUS=='1'?'预警':item.STATUS=='2'?'超时':'已完成'}}
                </td>
                <td >
                    <span class="hander oper" ui-sref="province.taskStatistics({id:item.ID,time:item.DEADLINE,
                    taskName:item.NAME,status:item.STATUS,info:item.INFO})">统计</span> &nbsp;
                    <span class=" hander oper" ng-if="item.csum==0" ng-click="deleteTask(item.ID)" style="margin-right: 10px">删除</span>
                    <span class="oper"  ng-show="item.ATTENDID!=null" style="color: red" ng-click="openFileLists(item)">查看附件</span>
                </td>
            </tr>
            </tbody>
        </table>
        <p class="dangerColor noDate"  ng-if="noData==true">无数据</p>
        <uib-pagination
                ng-change="pageType==1?getMsg():searchMsg()"
                total-items="items.total"
                ng-model="items.pageNo"
                items-per-page="items.pageSize"
                first-text="first"
                class="pagination"
                boundary-link-numbers="true"
                direction-links="false"
                rotate="false">
        </uib-pagination>
        <div class="clearfix"></div>
        <div class="task-alert">
            <div class="alert-title">操作提示</div>
            <div class="alert-content">{{textContent}}</div>
            <ul class="alert-button">
                <li ng-click="sureAlert()" ng-if="textContent=='确定删除吗?删除记录不可恢复！'">确定</li>
                <li ng-click="resetAlert(textContent)">{{textContent=='确定删除吗?删除记录不可恢复！'?'取消':'关闭'}}</li>
            </ul>
        </div>
    </div>

</div>
