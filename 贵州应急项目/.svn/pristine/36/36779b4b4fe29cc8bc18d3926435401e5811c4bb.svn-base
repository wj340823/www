
<div ng-controller="riskSourceCtrl" style="height:100%">
    <div ng-include="'partials/leftMenu.html'"></div>
    <div ng-mouseenter="home.navShow=true" ng-mouseleave="home.navShow=false">
    <div class="navigation">
        <!--<div class="navBtn" ng-click="toggleMenu(0)" ng-class="{'active':riskSource.navShow}">

        </div>-->
        <!--<div class="navBtn navBtn_new1" ng-click="toggleMenu(1)" ng-class="{'active':riskSource.introShow}" style="top:145px;">
            <div class="borderLine"></div><i class="iconfont icon-jiemugaikuang"></i>风险源概况
        </div>-->
        <div class="navBtn navBtn_new1" ng-click="toggleMenu(2)" ng-class="{'active':riskSource.searchShow}" style="top:135px;">
            <div class="borderLine"></div><i class="iconfont icon-dianyadengji"></i>风险源检索
        </div>
        <div class="navOptions" ng-show="riskSource.navShow" style="position: absolute; right: -100px; width: 330px">
            <div ui--sref="home" ui-sref-active="active">
            </div>

            <div ui--sref="emergency.emergencyMaterial">
            </div>

            <div class="active">
            </div>
            <div>
            </div>
        </div>
        <div class="riskIntro riskIntrochange" ng-show="riskSource.introShow">
            <div class="part">
                <div class="title">
                    <span>风险源统计</span>
                </div>
                <div class="content" style="height:124px;position:relative;">
                    <div cgs-echarts="rankPie" options="riskSource.rankPie" style="width:373px;height:124px;"></div>
                    <div class="pieNum">
                        <div ng-repeat="item in riskSource.rankPie.series[0].data">{{item.value}}个</div>
                    </div>
                </div>
            </div>
            <div class="part">
                <div class="title">
                    <span>各区域风险源数量排名</span>
                </div>
                <div class="content" style="height:330px;">
                    <div cgs-echarts="rankBar" options="riskSource.rankBar" style="width:373px;height:330px;"></div>
                </div>
            </div>
            <div title="关闭" class="disClose" ng-click="(riskSource.introShow=false)">
                <i class="iconfont icon-guanbi"></i>
            </div>
        </div>
        <div class="riskSearch riskIntrochange" ng-show="riskSource.searchShow" ng-class="{true:'scrub'}[scrubEffect]">
            <div class="title">
                <span>风险源检索</span>
            </div>
            <div class="content">
                <div class="theme">名称搜索</div>
                <div>
                    <input type="text" placeholder="请输入名称" ng-model="riskSource.comSearch" />
                    <button type="button" class="searchBtn" ng-click="searchSoure(riskSource.comSearch)"><i class="iconfont icon-sousuo"></i>&nbsp;搜索</button>
                </div>
                <div class="points">
                    <span ng-repeat="item in riskSource.recentInput" ng-click="riskSource.comSearch=item">{{item}}</span>
                </div>
                <div class="theme">搜索结果</div>
                <div cgs-slim options="{width:'100%',height:'275px',size:'5px',color:'#C8C8C8'}">
                    <div ng-repeat="item in riskSource.sourceCompanies" class="riskComItem cursor-pointer" ng-click="locateSource(item)">
                        <span>{{item.COMPANYNAME}}</span>
                    </div>
                </div>
            </div>
            <div title="关闭" class="disClose" ng-click="(riskSource.searchShow=false)">
                <i class="iconfont icon-guanbi"></i>
            </div>
        </div>

    </div>
    <div style="position: absolute;right: 9px;top: 301px;z-index: 10;font-size: 16px;width: 40px;padding: 15px 13px;background: #000;color: #bdbdbd;"
         ng-click="changeToList()" class="oper">切换列表</div>
    </div>
    <div class="legend ">
        <div>
            <div><div><img src="images/major1.png " /></div>重大风险源</div>
            <div><div><img src="images/large1.png " /></div>较大风险源</div>
            <div><div><i class="icon-dot "></i></div>一般风险源</div>
        </div>
    </div>
    <div class="materialCon" style="background:none" ng-show="risk.sourceInfo.company||risk.sourceInfo.overview">
        <div class="riskSourcePop" ng-show="risk.sourceInfo.company">
            <!--<div class="popContainer"></div>-->
            <div class="head">
                <span ng-bind="riskDetail.COMPANYNAME"></span>
                <i class="iconfont icon-guanbi" title="关闭" ng-click="closeRisk('company')"></i>
            </div>
            <div class="menuTable" ng-show="messageType=='company' || messageType== 'product'">
                <div class="messageCom" ng-click="selectMessage('company')" ng-class="{true:'messageActive'}[messageType=='company']">企业信息</div>
                <div class="messageCom" ng-click="selectMessage('product')" ng-class="{true:'messageActive'}[messageType=='product']">产品信息</div>
            </div>
        </div>
    </div>
    <!-- 一览表  -->
    <div class="riskSourcePop" ng-show="risk.sourceInfo.overview" style="width:calc(100% - 700px);min-width: 1000px;left: 350px;">
        <div class="head">
            <span ng-bind="riskDetail.COMPANYNAME"></span>
            <i class="iconfont icon-guanbi" title="关闭" ng-click="closePrint()"></i>
            <!--<button type="submit" class="print searchBtn" ng-click="print()">打印</button>-->
            <a type="submit" class="print searchBtn" ng-href="riskSource/downWord?companyId={{linkCompanyId}}">
                <i class="iconfont icon-daochu"></i> 导出word
            </a>
        </div>
        <div style="height: calc(100% - 40px)" ng-include="'partials/pop/yilanbiao.html'"></div>
    </div>
    <!-- 预案管理 -->
    <div class="riskSourcePop" ng-show="risk.sourceInfo.emergency" style="width:calc(100% - 700px);min-width: 1000px;left: 350px;">
        <div class="head">
            <span ng-bind="entDetail.COMPANYNAME"></span>
            <i class="iconfont icon-guanbi" title="关闭" ng-click="closePrint()"></i>
            <!--<button type="submit" class="print searchBtn" ng-click="print()">打印</button>-->
        </div>
        <div style="height: calc(100% - 40px)" ng-include="'partials/pop/emergency.html'"></div>
    </div>
    <div style="position: absolute;top: 63%;left: 10px;width: 290px;background-color: #000;height:250px">
        <div class="item-title" style="margin-top: 0" >风险源统计(总数{{account}})</div>
        <div cgs-echarts="warnBars" options="ccc" style="width:270px;height:200px; margin-left:10px; "></div>
    </div>

    <div style="position: absolute;top: 70px;left:0;background-color: #000;
    width: 100%;height: calc(100% - 70px);z-index: 15;padding: 20px;overflow-y: auto" ng-show="mapShow==false">
        <div style="width: 100%;padding: 0 10px; line-height: 50px;position: relative">
            <div style="position: absolute;right: 20px;" class="oper" ng-click="mapShow=true">地图</div>
            <div class="search-nav">
                企业名称：<input type="text" style="margin-right: 20px" placeholder="企业名称" ng-model="riskPage.keyword">
                行政区划(市州):
                <select style="margin-right: 20px" ng-model="riskPage.city" ng-change="riskPage.changeCity()">
                    <option value="">贵州省</option>
                    <option ng-repeat="item in riskPage.cities" value="{{item.id}}">{{item.name}}</option>
                </select>
                行政区划(区县):
                <select style="margin-right: 20px" ng-model="riskPage.county">
                    <option ng-repeat="item in riskPage.counties" value="{{item.id}}">{{item.name}}</option>
                </select>
                风险级别:
                <select style="margin-right: 20px" ng-model="riskPage.riskGrade">
                    <option ng-repeat="item in riskPage.grade" value="{{item}}">{{item}}</option>
                </select>
                <!--行业类别  风险源类型  风险物质    应急物资  应急设施  应急演练-->
                行业类别：<input type="text" style="margin-right: 20px" ><br>
                风险源类型：<input type="text" style="margin-right: 20px">
                应急设施：<input type="text" style="margin-right: 20px" >
                应急演练：<input type="text" style="margin-right: 20px" >
                <button class="searchBtn" style="margin-left: 20px" ng-click="changeToList()">
                    <i class="iconfont icon-sousuo"></i>搜索
                </button>
            </div>
        </div>
        <table style="max-height:calc(100% - 160px)">
            <thead>
                <tr>
                    <!--序号  行政区划（市州）  行政区划（区县）  企业名称  风险级别  行业类别  风险源类型  风险物质  备案状态  应急物资  应急设施  应急演练-->
                    <th>序号</th>
                    <th>行政区划（市州）</th>
                    <th>行政区划（区县）</th>
                    <th width="300">企业名称</th>
                    <th>风险级别</th>
                    <th>行业类别</th>
                    <th>风险源类型</th>
                    <th>风险物质</th>
                    <th>备案状态</th>
                    <th>应急物资</th>
                    <th>应急设施</th>
                    <th>应急演练</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="item in riskPage.list">
                    <td>{{riskPage.size*(riskPage.no-1)+$index+1}}</td>
                    <td>{{item.xzqyName2}}</td>
                    <td>{{item.xzqyName}}</td>
                    <td style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap;" title="{{item.COMPANYNAME}}">
                        {{item.COMPANYNAME}}
                    </td>
                    <td>{{item.RISKGRADE}}</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>已备案</td>
                    <td>有</td>
                    <td>应急池</td>
                    <td>-</td>
                </tr>
            </tbody>
        </table>
        <uib-pagination
                ng-change="changeToList()"
                total-items="riskPage.total"
                ng-model="riskPage.no"
                items-per-page="riskPage.size"
                boundary-link-numbers="true"
                force-ellipses="true"
                direction-links="false"
                max-size= "3"
                rotate="true">
        </uib-pagination>
    </div>

</div>
