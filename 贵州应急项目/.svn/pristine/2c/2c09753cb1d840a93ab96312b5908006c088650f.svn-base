package com.sucsoft.gzhbyjwz.controller;

import com.sucsoft.gzhbyjwz.bean.common.ResultBean;
import com.sucsoft.gzhbyjwz.service.YjInfosService;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.multipart.MultipartFile;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@RestController
@RequestMapping("/yjInfosImport")
@Api(value="YjInofsController",description="应急信息导入模块")
public class YjInofsController {

    @Autowired
    private YjInfosService yjInfosService;

    @ApiOperation(value = "EXCEL导入",httpMethod = "POST",notes = "EXCEL导入")
    @RequestMapping(value = "/addYjzjExcel",method = RequestMethod.POST)
    public ResultBean addYjzjExcel(HttpServletRequest request,
                                   String companyId,
                                   MultipartFile file
    ) throws Exception{

//        if (!userService.isAdmin()){
//            throw  new BadRequest("无导入权限");
//        }
        return yjInfosService.addYjzjExcel(request,companyId,file);
    }

    @ApiOperation(value = "EXCEL导出",httpMethod = "GET", notes = "EXCEL导出")
    @RequestMapping(value = "/exportExcel",method = RequestMethod.GET)
    public void exportedExcel(String companyId, HttpServletResponse response, HttpServletRequest request) throws Exception {
        yjInfosService.exportedExcel(companyId, response, request);
    }
}
