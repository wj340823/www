package com.sucsoft.gzhbyjwz.bean.param.riskManage;

import com.sucsoft.gzhbyjwz.bean.param.Param;
import com.sucsoft.gzhbyjwz.service.XzqyService;
import com.sucsoft.gzhbyjwz.util.DateUtils;
import io.swagger.annotations.ApiModelProperty;
import org.springframework.util.StringUtils;

import java.util.*;

public class EmergencyTaskParam implements Param {
    /**
     * 时间区间
     */
    @ApiModelProperty(value = "开始时间")
    private Long strTime;
    @ApiModelProperty(value = "结束时间")
    private Long endTime;
    @ApiModelProperty(value = "关键字")
    private String keywords;
    @ApiModelProperty(value = "行政区域ID")
    private String xzqyId;
    @ApiModelProperty(value = "附件类型 task = 任务附件 result = 任务总结")
    private String type;
    /**
     * 该行政区域下的所有叶子节点。
     */
    private List<String> xzqyIdList ;

    /**
     * 状态位:0-进行中，1-预警，2-超时，10-已完成,-1 全部
     */
    @ApiModelProperty(value = "状态位:0-进行中，1-预警，2-超时，10-已完成,-1 全部")
    private Integer status;

    /**
     * 任务当前的状态
     */
    private Integer taskStatus;

    @ApiModelProperty(value = "排查结论：-1 全部，1 存在应急隐患，2 存在重大隐患")
    private Integer result;

    public List<String> getXzqyIdList() {
        return xzqyIdList;
    }

    public void setXzqyIdList(List<String> xzqyIdList) {
        this.xzqyIdList = xzqyIdList;
    }

    public Integer getTaskStatus() {
        return taskStatus;
    }

    public void setTaskStatus(Integer taskStatus) {
        this.taskStatus = taskStatus;
    }

    public Integer getResult() {
        return result;
    }

    public void setResult(Integer result) {
        this.result = result;
    }

    public String getXzqyId() {
        return xzqyId;
    }

    public void setXzqyId(String xzqyId) {
        this.xzqyId = xzqyId;
    }

    public Integer getStatus() {
        return status;
    }

    public void setStatus(Integer status) {
        this.status = status;
    }

    public Long getStrTime() {
      return strTime;
    }

    public void setStrTime(Long strTime) {
      this.strTime = strTime;
    }

    public Long getEndTime() {
      return endTime;
    }

    public void setEndTime(Long endTime) {
      this.endTime = endTime;
    }

    public String getKeywords() {
        return keywords;
    }

    public void setKeywords(String keywords) {
        this.keywords = keywords;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    /**
     * 转换成传进yml的参数map
     * @return
     */
    @Override
    public Map toParam(){
        Date str = null;
        Date end = null;

        if (this.getStrTime() != null) {
            str = DateUtils.toDayStart(this.getStrTime());
        }
        if (this.getEndTime() != null) {
            end = DateUtils.toDayEnd(this.getEndTime());
        }

        Map map = new HashMap();
        map.put("starttime", str);
        map.put("strTime", str);
        map.put("endtime", end);
        map.put("endTime", end);
        if (!StringUtils.isEmpty(this.getKeywords())) {
            map.put("keywords", "%" + this.getKeywords() + "%");
        }
        //行政区域参数
        if (!(this.xzqyIdList == null || this.xzqyIdList.size()==0)){
            map.put("xzqyIdList", this.getXzqyIdList());
        }

        if (this.result != null){
            switch (this.result){
                case 1:{
                    map.put("hasEmergency",new byte[1]);break;
                }
                case 2:{
                    map.put("hasSignificant",new byte[1]);break;
                }
                default:break;
            }
        }

        //任务状态
        map.put("status",taskStatus);
        map.put("type",type);
        return map;
    }

}
