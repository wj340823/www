---
  grammer: SQL
  queries:
    #列表查询行政区域并排序
    - name: listXzqy
      resultType: Map
      statement:
        "
        select
          *
        from
          xzqy x
        where
          1=1
        #if($level)
          and x.level =:level
        #end
        #if($minLevel)
          and x.level >=:minLevel
        #end
        #if($maxLevel)
          and x.level <=:maxLevel
        #end
        order by x.sort
        "
    #列表查询行政区域并排序
    - name: listXzqyCountWarehouse
      resultType: Map
      statement:
        "
        SELECT
        	x. NAME AS name,
        	x.id AS id,
        	x.latitude AS latitude,
        	x.longitude AS longitude,
        	x.sort AS sort,
        	COUNT(DISTINCT h.ID) AS sum,
        	COUNT(DISTINCT e.COMPANYID) AS risksum
        FROM
        	xzqy x
        LEFT JOIN warehouse h ON h.XZQYID2 = x.ID
        LEFT JOIN enterpriseinformation e ON e.XZQYID2 = x.ID
        WHERE
        	1 = 1
        AND x. LEVEL = 2
        GROUP BY
        	x.ID
        ORDER BY
        	x.sort
        "
    #列表查询行政区域并排序
    - name: listXzqyCountRiskSource
      resultType: Map
      statement:
        "
        SELECT
          x.name as name,
          x.id as id,
          x.latitude as latitude,
          x.longitude as longitude,
          x.sort as sort,
          COUNT(e.COMPANYID) AS sum
        FROM
          xzqy x
        LEFT JOIN enterpriseinformation e ON e.XZQYID = x.ID
        WHERE
          1 = 1
        GROUP BY x.ID
        ORDER BY
          x.sort
        "
    #列表查询行政区域并排序
    - name: getUserById
      resultType: Map
      statement:
        "
        select
          *
        from authoxuser
        where 1=1
        #if($uid)
          and uid =:uid
        #end
        "
    - name: countEmergencyResource
      resultType: Map
      statement:
        "
        SELECT
        (SELECT COUNT(*) from warehouse ) AS warehouseSum,
        (SELECT COUNT(*) FROM managercrew) AS managercrewSum,
        (SELECT COUNT(DISTINCT UNIT) FROM managercrew) AS unitSum,
        (SELECT COUNT(*) from emergencyexample) AS emergencyexampleSum
        FROM dual
        "
    - name: countAtmosphericEvent
      resultType: Map
      statement:
        "
        SELECT COUNT(*) as sum from AtmosphericEvent
        "
    - name: listManagerCrewUnit
      resultType: Map
      fetches: []
      statement:
        "
        select
          DISTINCT UNIT
        from
          ManagerCrew
        where
          1=1
        #if($keywords)
          and (unit like :keywords)
        #end
        "

