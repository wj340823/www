<div  ng-controller="tbTodoCtrl">
    <div class="tab-task">
        <div class="tab-nav">
            <button class="tab-button" ui-sref="riskInvest.tabTodo" ui-sref-active="active">
                待办任务
            </button>
            <button class="tab-button" ui-sref="riskInvest.tabFinish" ui-sref-active="active">
                已办任务
            </button>
            <button class="tab-button" ui-sref="riskInvest.majorDanger" ui-sref-active="active">
                重大隐患
            </button>
            <button class="tab-button" ui-sref="riskInvest.generalDanger" ui-sref-active="active" >
                一般隐患
            </button>
            <button class="tab-button" ui-sref="riskInvest.manageDanger" ui-sref-active="active">
                应急管理隐患
            </button>
        </div>
    </div>
    <div class="table-content">
        <table style="margin-top: 16px;">
            <thead>
            <tr>
                <th>序号</th>
                <th>任务名称</th>
                <th>截止日期</th>
                <th>应急管理隐患排查表</th>
                <th>风险防控措施隐患排查表</th>
                <th>任务状态</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="item in obj.items">
                <td>{{obj.pageSize*(obj.currentPage-1)+$index+1}}</td>
                <td>{{item.NAME}}</td>
                <td >
                    {{item.DEADLINE|date:'yyyy-MM-dd'}}
                </td>
                <td  ui-sref="riskInvest.tbRiskCheck({itemNum:item.ID,
                type:1,name:item.NAME,company:item.ENTERPRISENAME,id:item.EMERGENCYMANAGEMENTID,operate:'yes'})"
                     class="hander">
                    <span  ng-class="item.status1==1?'pointGreen status':'pointOrange status'"></span>
                    {{item.status1!=1?'未完成':'已完成'}}
                </td>
                <td ui-sref="riskInvest.tbRiskPrevent({itemNum:item.ID,
                type:2,name:item.NAME,company:item.ENTERPRISENAME,id:item.RISKMANAGEMENTID,operate:'yes'})"
                    class="hander">
                    <span  ng-class="item.status2==1?'pointGreen status':'pointOrange status'"></span>
                    {{item.status2!=1?'未完成':'已完成'}}
                </td>
                <td ng-class="item.STATUS=='10'?'finishColor':item.STATUS=='1'?'warning':item.STATUS=='2'?'dangerColor':''">
                    {{item.STATUS=='10'?'已完成':item.STATUS=='1'?'预警':item.STATUS=='2'?'超时':'执行中'}}
                </td>
                <td>
                    <span class="hander oper"
                          ui-sref="riskInvest.taskInfo({itemNum:item.ID,name:item.NAME,company:
                          item.ENTERPRISENAME,id:item.RISKMANAGEMENTID,operate:'yes',hasDone:1})">
                        详情
                    </span>
                    <span class="hander oper" ng-if="item.status1==1&&item.status2==1" ng-click="msgSend(item.ID)">
                        提交
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
        <p class="dangerColor noDate"  ng-if="noData==true">无数据</p>
        <uib-pagination
                ng-change="getCurrentPage()"
                total-items="obj.total"
                ng-model="obj.currentPage"
                items-per-page="obj.pageSize"
                first-text="first"
                class="pagination"
                boundary-link-numbers="true"
                direction-links="false"
                rotate="false">
        </uib-pagination>
        <div class="clearfix"></div>
    </div>
    <div class="task-alert">
        <div class="alert-title">操作提示</div>
        <div class="alert-content">{{textContent}}</div>
        <ul class="alert-button">
            <li ng-click="sureAlert()" ng-if="textContent=='确定提交吗?'">确定</li>
            <li ng-click="resetAlert(textContent)">{{textContent=='确定提交吗?'?'取消':'关闭'}}</li>
        </ul>
    </div>
</div>
