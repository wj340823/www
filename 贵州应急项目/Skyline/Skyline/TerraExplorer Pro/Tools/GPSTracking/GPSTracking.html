<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>ToolTitle</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="StyleSheet" href="../Style.css" type="text/css">
    <style>
    </style>
</head>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" style="border: 0px" id="Body" class="hideUntillTranslated" onload="Init()" style="overflow-x:hidden">
    <!--oncontextmenu="return false;">  onclick="bHide=true;HideOptionsNow()" > -->
    <table border="0" width="100%" cellspacing="0" cellpadding="2">
        <tr>
            <td class="ToolTopArea" id="TopAreaTD" width="100%" valign="middle">
                <table border="0" width="100%" cellspacing="0" cellpadding="0">
                    <tr>
                        <td width="55px"><img style="margin-left:5px;" src="ToolIcon.png" alt="" /></td>
                        <td id="TitleTD" align="center" class="s12w i18n">ToolName</td>
                        <td align="right" id="CloseHelpTd"><img style="margin-right:5px;" alt="" src="../CommonImg/help.png" border="0" class="i18n" alt="help" title="help" onclick="DisplayHelpPopup6(SGLang.i18nFile('GPShelp.html'),SGLang.i18n('help'))" style="cursor: pointer;"></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td class="ToolTopSeperator"></td>
        </tr>
        <tr class="s8">
            <td>
                <table class="PropertiesSheet" cellspacing="0" cellpadding="2">
                    <form name="form1">

                        <tr>
                            <td align=top><span class="i18n">Text1</span></td>
                            <td align=left>
                                &nbsp;<select id="StreamType" size="1" onchange="StreamChanged()">
                                    <option value="TCP/IP">TCP/IP
                                    <option value="UDP">UDP
                                    <option value="COM1:">COM1
                                    <option value="COM2:">COM2
                                    <option value="COM3:">COM3
                                    <option value="COM4:">COM4
                                    <option value="COM5:">COM5
                                    <option value="COM6:">COM6
                                    <option value="COM7:">COM7
                                    <option value="COM8:">COM8
                                    <option value="COM9:">
                                        COM9
                                        <!--<OPTION VALUE="USB:" >USB -->
                                    <option value="FILE:" class="i18n" selected>Text2
                                </select>
                            </td>
                        </tr>

                        <p id="SerialConfig">
                    <tr class='TableOtherLine' style="display:none">
                        <td align=top class="s8b i18n">Text3</td>
                        <td align=left>
                            &nbsp;<select id="Bitspersecond" size="1" style="z-index:1;">
                                <option value="75">75
                                <option value="110">110
                                <option value="134">134
                                <option value="150">150
                                <option value="300">300
                                <option value="600">600
                                <option value="1200">1200
                                <option value="1800">1800
                                <option value="2400">2400
                                <option value="4800">4800
                                <option value="7200">7200
                                <option value="9600" selected>9600
                                <option value="14400">14400
                                <option value="19200">19200
                                <option value="38400">38400
                                <option value="57600">57600
                                <option value="115200">115200
                                <option value="128000">128000
                            </select>
                        </td>
                    </tr>

                    <tr class='TableOtherLine' style="display:none">
                        <td align=top class="s8b i18n">Text4</td>
                        <td align=left>
                            &nbsp;<select id="DataBits" size="1" style="z-index:1;">
                                <option value="4">4
                                <option value="5">5
                                <option value="6">6
                                <option value="7" selected>7
                                <option value="8">8
                            </select>
                        </td>
                    </tr>

                    <tr class='TableOtherLine' style="display:none">
                        <td align=top class="s8b i18n">Text5</td>
                        <td align=left>
                            &nbsp;<select id="Parity" size="1" style="z-index:1;">
                                <option value="E" class="i18n">Text6
                                <option value="O" class="i18n" selected>Text7
                                <option value="N" class="i18n">Text8
                                <option value="M" class="i18n">Text9
                                <option value="S" class="i18n">Text10
                            </select>
                        </td>
                    </tr>

                    <tr class='TableOtherLine' style="display:none">
                        <td align=top class="s8b i18n">Text11</td>
                        <td align=left>
                            &nbsp;<select id="StopBits" size="1" style="z-index:1;">
                                <option value="0">1
                                <option value="1">1.5
                                <option value="2">2
                            </select>
                        </td>
                    </tr>

                    <tr class='TableOtherLine' style="display:none">
                        <td align=top class="s8b i18n">Text12</td>
                        <td align=left>
                            &nbsp;<select id="Flowcontrol" size="1" style="z-index:1;">
                                <option value="2" class="i18n">Text13
                                <option value="1" class="i18n">Text14
                                <option value="0" class="i18n">Text15
                            </select>
                        </td>
                    </tr>

                    </p>


                    <p id="FileConfig">
                    <tr class='TableOtherLine' style="display:table-row">
                        <td class="s8b"><span id="StreamText" class="i18n">Text16</span> </td>
                        <td align=left valign=top height=25>
                            &nbsp;<input id="Streamfile" name="Streamfile" type="file" value="3" size="20" style="">
                        </td>
                    </tr>
                    </p>

                    <p id="IpPortConfig">
                    <tr class='TableOtherLine' style="display:none">
                        <td class="s8b"><span id="StreamText" class="i18n">Text17</span> </td>
                        <td align=left valign=top height=25>
                            &nbsp;<input id="StreamIp" name="StreamIp" type="text" value="127.0.0.1" size="20" style="">
                        </td>
                    </tr>

                    <tr class='TableOtherLine' style="display:none">
                        <td class="s8b"><span id="StreamText" class="i18n">Text18</span> </td>
                        <td align=left valign=top height=25>
                            &nbsp;<input id="StreamPort" name="StreamPort" type="text" value="85" size="20" style="">
                        </td>
                    </tr>
                    </p>

                    <tr>
                        <td><span class="i18n">Text19</span></td>
                        <td align=left>
                            &nbsp;<select id="NMEAString" size="1">
                                <option value="1">NMEA-0183 v2.1
                            </select>
                        </td>
                    </tr>

                    <tr class='TableOtherLine'>
                        <td><span class="i18n">Text20</span></td>
                        <td align=left>
                            &nbsp;<select id="UsePrivateTag" size="1" onchange="UsePrivateChanged()">
                                <option value="On" class="i18n">Text21
                                <option value="Off" class="i18n" selected>Text22
                            </select>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="i18n">Text23</span></td>
                        <td align=left>
                            &nbsp;<input id="PrivateTagText" name="PrivateTagText" type="text" value="" size="10" disabled>
                        </td>
                    </tr>

                    <tr class='TableOtherLine'>
                        <td><span class="i18n">Text24</span></td>
                        <td align=left>
                            &nbsp;<select id="StreamRate" size="1" onchange="StreamRateChanged()">
                                <option value="1">x1
                                <option value="2">x2
                                <option value="3">x3
                                <option value="4">x4
                                <option value="5">x5
                                <option value="10">x10
                                <option value="20">x20
                            </select>
                        </td>
                    </tr>

                    <tr>
                        <td align=top><span class="i18n">Text25</span></td>
                        <td align=left>
                            &nbsp;<select id="ObjectType" size="1" onchange="TypeChanged()">
                                <option value="TextLabel" class="i18n">Text26
                                <option value="ImageLabel" class="i18n">Text27
                                <option value="RegularPolygon" class="i18n">Text28
                                <option value="Arrow" class="i18n">Text29
                                <option value="Circle" class="i18n">Text30
                                <option value="Ellipse" class="i18n">Text31
                                <option value="3DModel" class="i18n">Text32
                                <option value="Box" class="i18n" selected>Text33
                                <option value="Cylinder" class="i18n">Text34
                                <option value="Sphere" class="i18n">Text35
                                <option value="Cone" class="i18n">Text36
                                <option value="Pyramid" class="i18n">Text37
                                <option value="3DArrow" class="i18n">Text38
                            </select>
                        </td>
                    </tr>

                    <tr class='TableOtherLine'>
                        <td><span id="SizeText" class="i18n">Text39</span></td>
                        <td align=left>
                            <input id="Size" name="Size" type="text" onchange="CheckNumber(form1.Size.value,2)" value="2" size="7"> <span id="SizeText2" style="width:35px"> </span>
                        </td>
                    </tr>

                    <tr>
                        <td><span id="paramText" class="i18n">Text40</span> </td>
                        <td align=left valign=top height=25>
                            <span id="filediv" style="display:none; width:10; height:20;"><input id="FileDivfile" name="FileDivfile" onchange="VBScript:bObjectParamChanged = true" type="file" value="3" size="20" style=""></span>
                            <span id="paramdiv" style="display:none; height:20; "><input id="Param" name="Param" onchange="CheckNumber(form1.Param.value,2)" type="text" class="i18n" value="Text41" size="20"> <span id="paramText2"> </span></span>
                        </td>
                    </tr>

                    <tr class='TableOtherLine'>
                        <td><span class="i18n">Text42</span></td>
                        <td align=left>
                            &nbsp;
                            <input id="ColorButton" class="ColorButton" type=button name=Color value="     " onclick="pop(ObjectColor)" style="width:50px;background:'#FF0000'">
                            <span id="ColorText">#FF0000  </span>
                            <span id="ObjectColor" style="display: none">
                                <table border=5 cellpadding=0 cellspacing=0>
                                    <tr><td class="ColorWin" bgcolor="#FF0000" value="#FF0000" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#800000" value="#800000" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#C00000" value="#C00000" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FF4040" value="#FF4040" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FF8080" value="#FF8080" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FFC0C0" value="#FFC0C0" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#000000" value="#000000" onclick="pick(Color,ColorText,ObjectColor)"></td> </tr>
                                    <tr><td class="ColorWin" bgcolor="#FFFF00" value="#FFFF00" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#808000" value="#808000" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#C0C000" value="#C0C000" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FFFF40" value="#FFFF40" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FFFF80" value="#FFFF80" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FFFFC0" value="#FFFFC0" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#202020" value="#202020" onclick="pick(Color,ColorText,ObjectColor)"></td> </tr>
                                    <tr><td class="ColorWin" bgcolor="#00FF00" value="#00FF00" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#008000" value="#008000" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#00C000" value="#00C000" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#40FF40" value="#40FF40" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#80FF80" value="#80FF80" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#C0FFC0" value="#C0FFC0" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#404040" value="#404040" onclick="pick(Color,ColorText,ObjectColor)"></td> </tr>
                                    <tr><td class="ColorWin" bgcolor="#00FFFF" value="#00FFFF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#008080" value="#008080" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#00C0C0" value="#00C0C0" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#40FFFF" value="#40FFFF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#80FFFF" value="#80FFFF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#C0FFFF" value="#C0FFFF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#808080" value="#808080" onclick="pick(Color,ColorText,ObjectColor)"></td> </tr>
                                    <tr><td class="ColorWin" bgcolor="#0000FF" value="#0000FF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#000080" value="#000080" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#0000C0" value="#0000C0" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#4040FF" value="#4040FF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#8080FF" value="#8080FF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#C0C0FF" value="#C0C0FF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#C0C0C0" value="#C0C0C0" onclick="pick(Color,ColorText,ObjectColor)"></td> </tr>
                                    <tr><td class="ColorWin" bgcolor="#FF00FF" value="#FF00FF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#800080" value="#800080" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#C000C0" value="#C000C0" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FF40FF" value="#FF40FF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FF80FF" value="#FF80FF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FFC0FF" value="#FFC0FF" onclick="pick(Color,ColorText,ObjectColor)"></td><td class="ColorWin" bgcolor="#FFFFFF" value="#FFFFFF" onclick="pick(Color,ColorText,ObjectColor)"></td> </tr>
                                </table>
                            </span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="i18n">Text43</span></td>
                        <td align=left>
                            &nbsp;<select id="DrawTrace" size="1" onchange="TraceChanged()">
                                <option value="Yes" class="i18n">Text21
                                <option value="No" class="i18n" selected>Text22
                            </select>
                        </td>
                    </tr>

                    <tr class='TableOtherLine'>
                        <td><span class="i18n">Text44</span></td>
                        <td align=left>&nbsp;<input id="TraceLenght" onchange="CheckNumber(form1.TraceLenght.value ,100)" name="TraceLenght" type="text" value="100" size="5" disabled></td>
                    </tr>

                    <tr>
                        <td><span class="i18n">Text45</span></td>
                        <td align=left>
                            &nbsp;<select id="SaveObjects" size="1">
                                <option value="1" class="i18n">Text46
                                <option value="2" class="i18n" selected>Text47
                                <option value="3" class="i18n">Text48
                            </select>
                        </td>
                    </tr>

                </table>
            </td>
        </tr>
        <tr class="s8">
            <td colspan="2">
                <button id="Connect" class="MenuButtonSmall" onclick="ConnectGPS(); ">        <span class="i18n">Text49</span></button>

                </FORM>

            </td>
        </tr>
    </table>




    </tr></td></table>
    <object id="SGWorld" classid="CLSID:3a4f9197-65a8-11d5-85c1-0001023952c1" style="visibility:hidden;height:0 "></object>
    <object id="GPS" classid="CLSID:1D1342E2-B737-43C4-B2B2-BB855FC353F1" style="visibility:hidden;height:0 "></object>

    <script language="javascript" src="../ToolsCommon65.js"></script>

    <script language="JavaScript">

        function InitHead() {
            if (GetParamValue("inSG", "") == "1") {
                document.getElementById("TopAreaTD").style.height = "57";
                document.getElementById("TitleTD").align = "left";
                document.getElementById("CloseHelpTd").style.display = "none";
            }
        }

        function GetParamValue(findParam, defaultValue) {
            var arr = document.location.href.split("?");
            if (arr.length <= 1) return defaultValue;
            arr = arr[1].split("&");
            for (var i = 0; i < arr.length; i++) {
                if (arr[i].indexOf(findParam) == 0 && arr[i].indexOf("=") == findParam.length) {
                    arr = arr[i].split("=");
                    return arr[1];
                }
            }
            return defaultValue;
        }

        var GroupID;
        var bConnected;
        var Object;
        var GPSGroupID;
        var bDrawTrace;
        var bObjectParamChanged;
        var dataone;
        var iobjmgr;
        var lastx;
        var lasty;
        var lastz;
        var useyaw;


        // -------------------------------------------------------------
        //  Init
        // -------------------------------------------------------------
        function Init() {
            lastx = -3000;
            useyaw = 0;
            dataone = false;
            InitHead();

            TypeChanged();
            Object = null;
            bConnected = false;
            bDrawTrace = false;
            bObjectParamChanged = true;
            Reset(1, 0);

            InitGroup();
            confStr = SGWorld.ProjectTree.GetClientData(GPSGroupID, "ConfigStr");
            if (confStr != "") {
                ProcessData(confStr);
            }

            GPS.attachEvent("OnInfoBlock", GPS_OnInfoBlock);
            StreamChanged();
            StreamRateChanged(); //To update GPS with initial GUI value
        }

        // -------------------------------------------------------------
        //  Init
        // -------------------------------------------------------------
        function Uninit() {
            GPS_OnEndOfStream();

            // this ensures that if you just set the stream without connecting, you'd still save your config data as long as you wanted to (if the group exists - if you delete the group, you don't want to
            // save it
            var tmpGroup = GetGroup();
            if (tmpGroup != 0)
                SGWorld.ProjectTree.SetClientData(tmpGroup, "ConfigStr", BuildConfigStr());
        }

        // -------------------------------------------------------------
        //  Reset
        // -------------------------------------------------------------
        function Reset(FirstTime, FromMouseInputMode) {
            bFirstTime = true;
            document.form1.Connect.value = SGLang.i18n("Text71");
            bInEdit = false;
        }

        // -------------------------------------------------------------
        //  streamChanged
        // -------------------------------------------------------------
        function StreamChanged() {
            if (document.form1.StreamType.value == "FILE:") {
                SetDivChildren("FileConfig", "block");
                SetDivChildren("SerialConfig", "none");
                SetDivChildren("IpPortConfig", "none");
            }
            else if ((document.form1.StreamType.value == "TCP/IP") || (document.form1.StreamType.value == "UDP")) {
                SetDivChildren("FileConfig", "none");
                SetDivChildren("SerialConfig", "none");
                SetDivChildren("IpPortConfig", "block");
            }
            else {
                SetDivChildren("FileConfig", "none");
                SetDivChildren("SerialConfig", "block");
                document.form1.StreamRate.value = "1";
                SetDivChildren("IpPortConfig", "none");
            }
        }

        // -------------------------------------------------------------
        //  StreamRateChanged
        // -------------------------------------------------------------
        function StreamRateChanged() {
            GPS.PlayRateFactor(document.form1.StreamRate.value);
        }

        // -------------------------------------------------------------
        //  TraceChanged
        // -------------------------------------------------------------
        function TraceChanged() {
            if (bDrawTrace) {
                bDrawTrace = false;
                form1.TraceLenght.disabled = true;
            }
            else {
                bDrawTrace = true;
                form1.TraceLenght.disabled = false;
            }
        }

        // -------------------------------------------------------------
        //  TypeChanged
        // -------------------------------------------------------------
        function TypeChanged() {
            document.form1.Param.disabled = false;

            bObjectParamChanged = true;
            if (document.form1.ObjectType.value == "TextLabel") {
                paramText.innerHTML = SGLang.i18n("Text54");
                document.form1.Param.value = "text";
                paramText2.innerHTML = "";
                SizeText.innerHTML = SGLang.i18n("Text55");
                SizeText2.innerHTML = "";
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "ImageLabel") {
                paramText.innerHTML = SGLang.i18n("Text56");
                document.form1.FileDivfile.value = abspath() + "\\icon.gif";
                paramText2.innerHTML = " ";
                SizeText.innerHTML = SGLang.i18n("Text55");
                SizeText2.innerHTML = "";
                document.form1.Size.value = "2";
                paramdiv.style.display = "none";
                filediv.style.display = "";
            }

            if (document.form1.ObjectType.value == "PrivateTextLabel") {
                paramText.innerHTML = SGLang.i18n("Text54");
                document.form1.Param.value = "Automatic";
                document.form1.Param.disabled = true;
                paramText2.innerHTML = "";
                SizeText.innerHTML = SGLang.i18n("Text55");
                SizeText2.innerHTML = "";
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "RegularPolygon") {
                paramText.innerHTML = SGLang.i18n("Text57");
                document.form1.Param.value = "5";
                paramText2.innerHTML = " ";
                SizeText.innerHTML = SGLang.i18n("Text58");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "Arrow") {
                paramText.innerHTML = SGLang.i18n("Text59");
                document.form1.Param.value = "";
                paramText2.innerHTML = " ";
                SizeText.innerHTML = SGLang.i18n("Text60");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "Circle") {
                paramText.innerHTML = SGLang.i18n("Text59");
                document.form1.Param.value = "";
                paramText2.innerHTML = " ";
                SizeText.innerHTML = SGLang.i18n("Text61");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "Ellipse") {
                paramText.innerHTML = SGLang.i18n("Text62");
                document.form1.Param.value = "4";
                paramText2.innerHTML = SGLang.i18n("Text58");
                SizeText.innerHTML = SGLang.i18n("Text61");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "3DModel") {
                paramText.innerHTML = SGLang.i18n("Text56");
                document.form1.Param.value = abspath() + "\\leftturn.xpc";
                paramText2.innerHTML = " ";
                SizeText.innerHTML = SGLang.i18n("Text55");
                SizeText2.innerHTML = "";
                document.form1.Size.value = "2";
                paramdiv.style.display = "none";
                filediv.style.display = "";
            }

            if (document.form1.ObjectType.value == "Box") {
                paramText.innerHTML = SGLang.i18n("Text63");
                document.form1.Param.value = "2";
                paramText2.innerHTML = SGLang.i18n("Text58");
                SizeText.innerHTML = SGLang.i18n("Text64");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "Cylinder") {
                paramText.innerHTML = SGLang.i18n("Text65");
                document.form1.Param.value = "2";
                paramText2.innerHTML = SGLang.i18n("Text58");
                SizeText.innerHTML = SGLang.i18n("Text66");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "Sphere") {
                paramText.innerHTML = SGLang.i18n("Text59");
                document.form1.Param.value = "";
                paramText2.innerHTML = " ";
                SizeText.innerHTML = SGLang.i18n("Text61");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "Cone") {
                paramText.innerHTML = SGLang.i18n("Text67");
                document.form1.Param.value = "2";
                paramText2.innerHTML = SGLang.i18n("Text58");
                SizeText.innerHTML = SGLang.i18n("Text64");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "Pyramid") {
                paramText.innerHTML = SGLang.i18n("Text68");
                document.form1.Param.value = "2";
                paramText2.innerHTML = SGLang.i18n("Text58");
                SizeText.innerHTML = SGLang.i18n("Text64");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }

            if (document.form1.ObjectType.value == "3DArrow") {
                paramText.innerHTML = SGLang.i18n("Text69");
                document.form1.Param.value = "2";
                paramText2.innerHTML = SGLang.i18n("Text58");
                SizeText.innerHTML = SGLang.i18n("Text70");
                SizeText2.innerHTML = SGLang.i18n("Text58");
                document.form1.Size.value = "2";
                paramdiv.style.display = "";
                filediv.style.display = "none";
            }
        }

        // -------------------------------------------------------------
        //  HTMLColor2TeColor
        // -------------------------------------------------------------
        function HTMLColor2TeColor(color) {
            var d = 0;
            if (color.substr(0, 1) == "#")
                d = 1;

            var rgbObj = hexToRgb(color.substr(d, 6));

            return rgbObj.b * 65536 + rgbObj.g * 256 + rgbObj.r;
        }

        function hexToRgb(hex) {
            // Expand shorthand form (e.g. "03F") to full form (e.g. "0033FF")
            var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
            hex = hex.replace(shorthandRegex, function (m, r, g, b) {
                return r + r + g + g + b + b;
            });

            var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        // -------------------------------------------------------------
        //  rad
        // -------------------------------------------------------------
        function rad(num) {
            rad = num / 180.0 * 3.1415926535897932384626433832795;
        }

        // -------------------------------------------------------------
        //  deg
        // -------------------------------------------------------------
        function deg(num) {
            deg = num * 180.0 / 3.1415926535897932384626433832795;
        }

        // -------------------------------------------------------------
        //  atn2
        // -------------------------------------------------------------
        function atn2(dx, dy) {
            rdx = Math.abs(dx);
            rdy = Math.abs(dy);

            if (rdx > rdy)
                tmp = deg(Math.atan(rdy / rdx));
            else
                tmp = 90 - deg(Math.atan(rdx / rdy));

            if (dx < 0)
                tmp = 180 - tmp;

            if (dy < 0)
                tmp = 360 - tmp;

            return tmp;
        }


        // --------------------------------------
        //  POP
        // --------------------------------------
        function pop(id) {
            if (id.style.display == "")
                id.style.display = "none";
            else id.style.display = "";
        }

        function RightString(str, n) {
            if (n <= 0)
                return "";
            else if (n > String(str).length)
                return str;
            else {
                var intLen = String(str).length;
                return String(str).substring(intLen, intLen - n);
            }
        }


        function LeftString(str, n) {
            if (n <= 0)
                return "";
            else if (n > String(str).length)
                return str;
            else
                return String(str).substring(0, n);
        }

        // --------------------------------------
        //  GPS_OnInfoBlock
        // sub GPS_OnInfoBlock(id, X,Y, Z, Time)
        // --------------------------------------
        function GPS_OnInfoBlock(id, callsign, X, Y, Z, speed, tyaw, Time) {
            InitGroup();
            if (!bConnected)
                return;
            id = LeftString(id, 6);
            if (dataone == false) {
                text = "Updating GPS Object " + id;
                SGWorld.Window.ShowMessageBarText(text, -1, 500);
                dataone = true;
            }

            var ItemID;
            var TraceID;
            Z = Z - SGWorld.Terrain.GetGroundHeightInfo(X, Y, 2).Position.Altitude; // ACCURACY_BEST_FROM_MPT = 2


            // Draw trace line
            if (bDrawTrace) {
                TraceID = SGWorld.ProjectTree.FindItem("GPS Objects\\Trace Lines\\" + id + "-Trace");
                if (TraceID != "") // Trace exists
                {
                    Object = SGWorld.ProjectTree.GetObject(TraceID);
                    var points = Object.Geometry;
                    points.StartEdit();
                    points.Points.AddPoint(X, Y, Z);
                    if (points.NumPoints > validateNumber(document.form1.TraceLenght.value))
                        points.Points.DeletePoint(0);
                    points.EndEdit();
                }
                else //Create new trace line
                {
                    GPSTraceGroupID = SGWorld.ProjectTree.FindItem("GPS Objects\\Trace Lines");
                    if (GPSTraceGroupID == "")
                        GPSTraceGroupID = SGWorld.ProjectTree.CreateGroup("Trace Lines", GPSGroupID);
                    var cLineString = [
                           X, Y, Z,
                           X, Y, Z
                    ];
                    var points = SGWorld.Creator.GeometryCreator.CreateLineStringGeometry(cLineString);
                    var IPoly = SGWorld.Creator.CreatePolyline(points, document.form1.Color.style.backgroundColor, 0, GPSTraceGroupID, id + "-Trace");
                }
            }
            ItemID = SGWorld.ProjectTree.FindItem("GPS Objects\\" + id);
            if (tyaw != 1000) {
                useyaw = tyaw;
                usespeed = speed;
            }
            else if (lastx != -3000) {
                var pos1 = SGWorld.Creator.CreatePosition(lastx, lasty, lastz, 0, useyaw, 0, 0, 0);
                var pos2 = SGWorld.Creator.CreatePosition(X, Y, Z, 0, 0, 0, 0, 0);
                SGWorld.CoordServices.GetAimingAngles(pos1, pos2);
            }

            lastx = X;
            lasty = Y;
            lastz = Z;

            if (ItemID != "") // Object exists
            {
                if (bObjectParamChanged) {
                    SGWorld.ProjectTree.DeleteItem(ItemID);
                    bObjectParamChanged = false;
                }
                else {
                    Object = SGWorld.ProjectTree.GetObject(ItemID);
                    Object.Position.X = X;
                    Object.Position.Y = Y;
                    Object.Position.Altitude = Z;
                    if (Object.ObjectType == 14) {
                        Object.Position.Yaw = 0;
                    }
                    else Object.Position.Yaw = useyaw;
                    SetToolTip(Object, callsign, X, Y, Z, tyaw, useyaw, speed);
                    return;
                }
            }

            X1 = X;
            Y1 = Y;
            Altitude = Z;
            var position = SGWorld.Creator.CreatePosition(X1, Y1, Altitude, 0, 0, 0, 0, 0);
            if (document.form1.ObjectType.value == "TextLabel") {
                cLabelStyle = SGWorld.Creator.CreateLabelStyle();
                var cBackgroundColor = cLabelStyle.BackgroundColor;     // Get label style background color
                cBackgroundColor.FromHTMLColor(document.form1.Color.style.backgroundColor);
                cBackgroundColor.SetAlpha(0.0);
                cLabelStyle.BackgroundColor = cBackgroundColor;         // Set label style background color
                cLabelStyle.Scale = validateNumber(document.form1.Size.value);                                  // Set label style scale

                Object = SGWorld.Creator.CreateTextLabel(position, document.form1.Param.value, cLabelStyle, GPSGroupID, id);
            }

            if (document.form1.ObjectType.value == "ImageLabel") {
                cLabelStyle = SGWorld.Creator.CreateLabelStyle();
                var cBackgroundColor = cLabelStyle.BackgroundColor;     // Get label style background color
                cBackgroundColor.FromHTMLColor(document.form1.Color.style.backgroundColor);
                cBackgroundColor.SetAlpha(0.0);
                cLabelStyle.BackgroundColor = cBackgroundColor;         // Set label style background color
                cLabelStyle.Scale = validateNumber(document.form1.Size.value);                                  // Set label style scale
                cLabelStyle.LimitScreenSize = false;

                Object = SGWorld.Creator.CreateImageLabel(position, document.form1.FileDivfile.value, cLabelStyle, GPSGroupID, id);
            }

            if (document.form1.ObjectType.value == "PrivateTextLabel") {
                Object = SGWorld.Creator.CreateTextLabel(position, id, 0, GPSGroupID, id);
                Object.Style.Scale = validateNumber(document.form1.Size.value);
                Object.Style.BackgroundColor.FromHTMLColor(document.form1.Color.style.backgroundColor);
                Object.Style.BackgroundColor.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "RegularPolygon") {
                Object = SGWorld.Creator.CreateRegularPolygon(position, validateNumber(document.form1.Size.value), validateNumber(document.form1.Param.value), document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "Arrow") {
                Object = SGWorld.Creator.CreateArrow(position, validateNumber(document.form1.Size.value), 1, document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }
            if (document.form1.ObjectType.value == "Circle") {
                Object = SGWorld.Creator.CreateCircle(position, validateNumber(document.form1.Size.value), document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "Ellipse") {
                Object = SGWorld.Creator.CreateEllipse(position, validateNumber(document.form1.Size.value), validateNumber(document.form1.Param.value), document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, 16, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "3DModel") {
                Object = SGWorld.Creator.CreateModel(position, document.form1.FileDivfile.value, validateNumber(document.form1.Size.value), 0, GPSGroupID, id);
                Object.Position.Yaw = useyaw;
            }

            if (document.form1.ObjectType.value == "Box") {
                Object = SGWorld.Creator.CreateBox(position, validateNumber(document.form1.Size.value), validateNumber(document.form1.Size.value), validateNumber(document.form1.Param.value), document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "Cylinder") {
                Object = SGWorld.Creator.CreateCylinder(position, validateNumber(document.form1.Size.value), validateNumber(document.form1.Param.value), document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, 18, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "Sphere") {
                Object = SGWorld.Creator.CreateSphere(position, validateNumber(document.form1.Size.value), 0, document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, 10, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "Cone") {
                Object = SGWorld.Creator.CreateCone(position, validateNumber(document.form1.Size.value), validateNumber(document.form1.Param.value), document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, 18, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "Pyramid") {
                Object = SGWorld.Creator.CreatePyramid(position, validateNumber(document.form1.Size.value), validateNumber(document.form1.Size.value), validateNumber(document.form1.Param.value), document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }

            if (document.form1.ObjectType.value == "3DArrow") {
                Object = SGWorld.Creator.Create3DArrow(position, validateNumber(document.form1.Size.value), 1, validateNumber(document.form1.Param.value), document.form1.Color.style.backgroundColor, document.form1.Color.style.backgroundColor, GPSGroupID, id);
                Object.FillStyle.Color.SetAlpha(0.0);
            }
            SetToolTip(Object, callsign, X, Y, Z, tyaw, useyaw, speed);
            Object.Attachment.AutoDetach = false;
        }

        function SetToolTip(Object, callsign, X, Y, Z, oyaw, yaw, speed) {
            var ToolTipBuilder;

            if (callsign != "")
                ToolTipBuilder = "Callsign: " + callsign + "\n";
            else ToolTipBuilder = "";

            ToolTipBuilder = ToolTipBuilder + "Latitude: " + Y.toFixed(5) + "\n" + "Longitude: " + X.toFixed(5) + "\n" + "Altitude: " + Z.toFixed(5) + " meters";
            if (oyaw != 1000) // 1000 keys us to know we don't have a yaw from the feed right now
                ToolTipBuilder = ToolTipBuilder + "\n" + "Heading: " + yaw.toFixed(5) + "\n" + "Speed: " + speed.toFixed(5) + " knots";
            else
                ToolTipBuilder = ToolTipBuilder + "\n" + "**Heading: " + yaw.toFixed(5) + "\n" + "Speed: " + speed.toFixed(5) + " knots";
            //Object.ToolTip.Text = ToolTipBuilder;			// Removed this line because it causes TE to crash
        }

        // --------------------------------------
        //  GPS_OnEndOfStream
        // --------------------------------------
        function GPS_OnEndOfStream() {
            if (!bConnected) return;
            ConnectGPS();   // To disconnect
        }

        function BuildConfigStr() {
            var ConfStr;
            if (document.form1.StreamType.value == "FILE:")
                ConfStr = document.form1.Streamfile.value;
            else if (document.form1.StreamType.value == "TCP/IP")
                ConfStr = "TCPIP:" + document.form1.StreamIp.value + ":" + document.form1.StreamPort.value;
            else if (document.form1.StreamType.value == "UDP")
                ConfStr = "UDP:" + document.form1.StreamIp.value + ":" + document.form1.StreamPort.value;
            else {
                ConfStr = document.form1.StreamType.value + document.form1.Bitspersecond.value + ":" + document.form1.DataBits.value + ":" + document.form1.Parity.value + ":" + document.form1.StopBits.value + ":" + document.form1.Flowcontrol.value; //"9600:7:O:0"
            }
            return ConfStr;
        }

        // -------------------------------------------------------------
        //  ConnectGPS
        // -------------------------------------------------------------
        function ConnectGPS() {
            if (SGWorld.Project.Name == "") return;

            InitGroup();
            SGWorld.ProjectTree.SetClientData(GPSGroupID, "ConfigStr", BuildConfigStr());

            if (bConnected) {
                dataone = false;
                document.form1.Connect.value = SGLang.i18n("Text71");
                SGWorld.Window.ShowMessageBarText(SGLang.i18n("Text51"), 1, 500);
                bConnected = false;
                GPS.Close();
                Object = null;
                //Delete/Keep/Save objects
                DeleteGPSObjects(GPSGroupID);
                EnableDisable(false);
            }
            else {
                if (document.form1.StreamType.value == "FILE:")
                    if (document.form1.Streamfile.value == "") {
                        alert(SGLang.i18n("Text52"));
                        return;
                    }
                if (document.form1.ObjectType.value == "3DModel") {
                    if (document.form1.FileDivfile.value == "") {
                        alert(SGLang.i18n("Text73"));
                        return;

                    }
                }
                document.form1.Connect.value = SGLang.i18n("Text72");
                SGWorld.Window.ShowMessageBarText(SGLang.i18n("Text53"), 1, 500);
                bConnected = true;
                EnableDisable(true);
                GPSTraceGroupID = SGWorld.ProjectTree.FindItem("GPS Objects\\Trace Lines");
                if (GPSTraceGroupID != 0)
                    SGWorld.ProjectTree.DeleteItem(GPSTraceGroupID);
                var PrivateTag;
                if (form1.UsePrivateTag.value == "Off")
                    PrivateTag = "";
                else
                    if (form1.PrivateTagText.value == "")
                        PrivateTag = "";
                    else PrivateTag = form1.PrivateTagText.value;

                var buildStr = BuildConfigStr();
                GPS.Open(buildStr, 1, PrivateTag);
            }
        }

        // -------------------------------------------------------------
        //  EnableDisable
        // -------------------------------------------------------------
        function EnableDisable(bDisable) {
            form1.StreamType.disabled = bDisable;
            form1.Streamfile.disabled = bDisable;
            form1.NMEAString.disabled = bDisable;
            form1.ObjectType.disabled = bDisable;
            form1.Size.disabled = bDisable;
            form1.FileDivfile.disabled = bDisable;
            form1.Param.disabled = bDisable;
            form1.ColorButton.disabled = bDisable;
            SetDivChildrenEnable("FileConfig", bDisable);
            SetDivChildrenEnable("SerialConfig", bDisable);
            SetDivChildrenEnable("IpPortConfig", bDisable);
        }

        // -------------------------------------------------------------
        //  DeleteGPSObjects
        // -------------------------------------------------------------
        function DeleteGPSObjects(GroupID) {
            InitGroup();
            if (GPSGroupID == "") return; // Group was not created
            if (form1.SaveObjects.value == 3) return; // Save in FLY Project": Objects will be saved-> Nothing to do
            var SiblingItemID;
            var CurObject;

            SiblingItemID = SGWorld.ProjectTree.GetNextItem(GroupID, 11); // CHILD – 11
            if (SiblingItemID == "") return;
            while (SiblingItemID != "") {
                if (SGWorld.ProjectTree.IsGroup(SiblingItemID)) {
                    DeleteGPSObjects(SiblingItemID);
                    SiblingItemID = SGWorld.ProjectTree.GetNextItem(SiblingItemID, 13);
                }
                else
                    switch (form1.SaveObjects.value) {
                        case "1": // Delete At Disconnect
                            ItemID2Delete = SiblingItemID;
                            SiblingItemID = SGWorld.ProjectTree.GetNextItem(SiblingItemID, 13);
                            SGWorld.ProjectTree.DeleteItem(ItemID2Delete);
                            break;
                        case "2": // Keep Alive While in Project
                            CurObject = SGWorld.ProjectTree.GetObject(SiblingItemID);
                            CurObject.SaveInFlyFile = false;
                            SiblingItemID = SGWorld.ProjectTree.GetNextItem(SiblingItemID, 13);
                            break;
                        default:
                            break;
                    }
            }
        }

        // -------------------------------------------------------------
        //  UsePrivateChanged
        // -------------------------------------------------------------
        function UsePrivateChanged() {
            if (form1.UsePrivateTag.value == "Off") {
                form1.PrivateTagText.disabled = true;
                document.form1.ObjectType.remove(1);
                document.form1.ObjectType.selectedIndex = 7;
                TypeChanged();
            }
            else {
                form1.PrivateTagText.disabled = false;
                oNewItem = document.createElement("OPTION");
                oNewItem.value = "PrivateTextLabel";
                oNewItem.text = "Text Label (Private)";
                document.form1.ObjectType.appendChild(oNewItem, 1);
            }
        }

        // -------------------------------------------------------------
        //  GetGroup
        // -------------------------------------------------------------
        function GetGroup() {
            if (SGWorld.Project.Name == "") {
                GetGroup = 0;
                return;
            }
            GetGroup = SGWorld.ProjectTree.FindItem("GPS Objects");
            return GetGroup;
        }

        // -------------------------------------------------------------
        //  InitGroup
        // -------------------------------------------------------------
        function InitGroup() {
            if (SGWorld.Project.Name == "") return;
            GPSGroupID = SGWorld.ProjectTree.FindItem("GPS Objects");
            if (GPSGroupID == "")
                GPSGroupID = SGWorld.ProjectTree.CreateGroup("GPS Objects");
        }

        // -------------------------------------------------------------
        //  TE_OnLoadFinished
        // -------------------------------------------------------------
        function TE_OnLoadFinished() {
            InitGroup();
        }

        // --------------------------------------
        //  CheckNumber
        // --------------------------------------
        function CheckNumber(field) {
            field = validateNumber(field);
        }

        // --------------------------------------
        //  GetNextToken
        // --------------------------------------
        var NextIndex;

        function GetNextToken(someString, colonInd) {
            col1 = colonInd + 1;
            NextIndex = someString.indexOf(":", col1);
            if (NextIndex > col1)
                GetNextToken = someString.substr(col1 - 1, NextIndex - col1);
            else
                GetNextToken = someString.substr(col1);
        }

        // --------------------------------------
        //  ProcessData
        // --------------------------------------
        function ProcessData(ConfigStr) //', TrackStr)
        {
            try {
                col1 = ConfigStr.indexOf(":");
                if (ConfigStr.substr(0, col1 - 1) == "TCPIP") {
                    document.form1.StreamType.value = "TCP/IP";
                    StreamChanged();
                    document.form1.StreamIp.value = GetNextToken(ConfigStr, col1);
                    document.form1.StreamPort.value = GetNextToken(ConfigStr, NextIndex);
                }
                else if (ConfigStr.substr(0, 3) == "COM") {
                    document.form1.StreamType.value = ConfigStr.substr(0, col1);
                    StreamChanged();
                    document.form1.Bitspersecond.value = GetNextToken(ConfigStr, col1);
                    document.form1.DataBits.value = GetNextToken(ConfigStr, NextIndex);
                    document.form1.Parity.value = GetNextToken(ConfigStr, NextIndex);
                    document.form1.StopBits.value = GetNextToken(ConfigStr, NextIndex);
                    document.form1.FlowControl.value = GetNextToken(ConfigStr, NextIndex);
                }
                else if (ConfigStr.substr(0, col1 - 1) == "UDP_MC") {
                    document.form1.StreamType.value = "UDP";
                    StreamChanged();
                    document.form1.StreamIp.value = GetNextToken(ConfigStr, col1);
                    document.form1.StreamPort.value = GetNextToken(ConfigStr, NextIndex);
                }
                else if (ConfigStr.substr(0, col1 - 1) == "UDP") {
                    document.form1.StreamType.value = "UDP";
                    StreamChanged();
                    document.form1.StreamIp.value = GetNextToken(ConfigStr, col1);
                    document.form1.StreamPort.value = GetNextToken(ConfigStr, NextIndex);
                }
                else {
                    document.form1.StreamType.value = "FILE:";
                    StreamChanged();
                    document.form1.Streamfile.value = ConfigStr;
                }
            }
            catch (Err) {
                if (Err.Number > 0) {
                    document.form1.StreamType.value = "FILE:";
                    StreamChanged();
                    document.form1.Streamfile.value = ConfigStr;
                }
            }
        }

        function pick(ButtonID, TextID, SpanID) {
            //  ColorPicker.style.visibility="hidden";
            pop(SpanID);
            ButtonID.style.backgroundColor = window.event.srcElement.value;
            TextID.innerHTML = window.event.srcElement.value;
            bObjectParamChanged = true;
        }

        //-------------------------------------------------------------
        // SetDivChildren
        //-------------------------------------------------------------
        function SetDivChildren(name, vis) {
            divobj = document.getElementById(name);


            for (i = 0; i < divobj.children.length; i++) {
                divobj.children[i].style.display = vis;
            }
        }

        //-------------------------------------------------------------
        // SetDivChildrenEnable
        //-------------------------------------------------------------
        function SetDivChildrenEnable(name, en) {
            divobj = document.getElementById(name);


            for (i = 0; i < divobj.children.length; i++) {
                divobj.children[i].children[1].disabled = en;

            }
        }

    </script>
</body>

</html>


<!--Sig:00000040AuQcimiSqBGzfDUMWjO3lu5Kzp7Jhp.#vNn4.XhMm0lOiVTWVIHnvzj03hEufaaoT0T3E9XGuBhPy4QBvdalXqJJ-->
