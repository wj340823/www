
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>ToolTitle</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="StyleSheet" href="../Style.css" type="text/css">
    <link type="text/css" rel="StyleSheet" href="slider.css" />
    <script language="javascript" src="../ToolsCommon65.js"></script>
    <script type="text/javascript" src="range.js"></script>
    <script type="text/javascript" src="timer.js"></script>
    <script type="text/javascript" src="slider.js"></script>
</head>
<body onLoad="init();" onunload="exit(true);" style="overflow: hidden; border: 0; background-color: #404040" leftmargin='0' topmargin="0" marginwidth="0" marginheight="0" >
    <table border=0  cellpadding="0" cellspacing="0" width="100%" height="100%">
        <tr valign="middle">
            <td style="width:30px;">
                <img src="Images/icon.png" align="bottom" alt="" />
            </td>
            <td style="background-image:url(images/zoombar.jpg); background-repeat:no-repeat;background-position:center; width:260px; ">
                <div id="sliderJpegQuality" style="display: compact"><input type="text" id="txtJpegQuality" /></div>
            </td>
            <td align="center">
                <span id="distanceID" style="color:#CCDAE5;"></span>
            </td>
        </tr>
    </table>

    <span id="spanJpegQuality" style="display:none">53</span>
    <object id="SGWorld" classid="CLSID:3a4f9197-65a8-11d5-85c1-0001023952c1">
    </object>

    <script language="JavaScript">

var sliderJpegQuality;
var LastPosition;
var OriginalZoomLevel;
var screenOverlay;
var alreadyUnload = false;
var gUnit = 0;
//
// init
function init() {
    OriginalZoomLevel = SGWorld.Navigate.FieldOfView;
    SGWorld.Command.Execute(1051, 0);

    sliderJpegQuality = new Slider(document.getElementById("sliderJpegQuality"),
                document.getElementById("txtJpegQuality"));
    sliderJpegQuality.setValue(OriginalZoomLevel);
    sliderJpegQuality.setMinimum(4);
    sliderJpegQuality.setMaximum(90);
    sliderJpegQuality.onchange = function () {
        document.getElementById("spanJpegQuality").innerHTML = sliderJpegQuality.getValue();
        zoom(sliderJpegQuality.getValue());
    };



    SGWorld.AttachEvent("onFrame", myOnFrame);
    SGWorld.AttachEvent("onMouseWheel", myOnMouseWheel);
    SGWorld.AttachEvent("OnMButtonDown", myOnMButtonDown);
    SGWorld.AttachEvent("OnMButtonUp", myOnMButtonDown);


    LastPosition = SGWorld.Navigate.GetPosition();

    //screenOverlay = SGWorld.Creator.CreateKMLLayer(abspath() + "/Binoculars.kml", SGWorld.ProjectTree.HiddenGroupID);
    //screenOverlay.ClientData("_SaveOptions_") = 1

    gUnit = SGWorld.GetOptionParam("AltitudeAndDistance");
}
//
// exit
function exit(fromUnload) {

    if (alreadyUnload )
     return;

    alreadyUnload = true;
    try {
        SGWorld.Navigate.FieldOfView = OriginalZoomLevel;
        SGWorld.Command.Execute(1049, 0);
        //SGWorld.ProjectTree.DeleteItem(screenOverlay.ID);

        if (!fromUnload) // without this if, it creates problems in SGWP
        {
            SGWorld.Window.RemovePopupByCaption(SGLang.i18n("ToolName"));
        }
    }
    catch (e) {}
}
//
function myOnMButtonDown(Flags, X, Y) {
    return true;
}
//
function myOnMButtonUp(Flags, X, Y) {
    return true;
}

//
// onFrame
function myOnFrame() {
    try {
        var centerPointPos = SGWorld.Window.CenterPixelToWorld().Position;
        var myPos = SGWorld.Navigate.GetPosition();
        var distance = myPos.DistanceTo(centerPointPos);
        var distanceStr = "";

        if (gUnit == 0) {
            if (distance < 10000)
                distanceStr = Math.round(distance) + " m";
            else if (distance < 100000)
                distanceStr = (distance / 1000).toFixed(1) + " km";
            else
                distanceStr = "-----";
        }
        else {
            distance = distance * 3.28084;
            if (distance < 10000)
                distanceStr = Math.round(distance) + " ft";
            else if (distance < 100000 * 3.28084)
                distanceStr = (distance / 5280).toFixed(1) + " mil";
            else
                distanceStr = "-----";
        }


        $("#distanceID").text(distanceStr);
    }
    catch (err) { }
/**
    try {
        if (SGWorld.Window.GetInputMode() == 0) {   // Free flight
            SGWorld.Navigate.SetPosition(LastPosition);
        }
        else
            LastPosition = SGWorld.Navigate.GetPosition();
    }
    catch (e) { return }
**/
}
//
// myOnMouseWheel
function myOnMouseWheel(flags, deltaZ, x, y) {
    slider = sliderJpegQuality.getValue();
    slider = slider + (-1 * deltaZ) / 60;

    sliderJpegQuality.setValue(slider);
    zoom(sliderJpegQuality.getValue());
    return true;
}

//
// zoom
function zoom(level) {
    SGWorld.Navigate.FieldOfView = level;
}

//
// Reset zoom
function resetZoom() {
    sliderJpegQuality.setValue(53);
    //zoom(53); sliderJpegQuality.setValue(53);
}

        
    </script>
</body>
</html>


<!--Sig:00000040oEYXP.XQOoJaozf6pitRBwgGYxfM768dscYIyRmurVkZcnqZEAob6Tw2DUCuHRUqDkhH0CgwrM#NoDbe3wHZMKJJ-->
